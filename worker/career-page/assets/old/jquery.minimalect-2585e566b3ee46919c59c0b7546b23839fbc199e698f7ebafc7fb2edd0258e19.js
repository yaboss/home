!function(i,s,e,t){function l(s,e){this.element=i(s),this.options=i.extend({},a,e),this._defaults=a,this._name=n,this.init()}var n="minimalect",a={theme:"",transition:"fade",placeholder:"Select a choice",empty:"No results match your keyword.",class_container:"minict_wrapper",class_group:"minict_group",class_empty:"minict_empty",class_active:"active",class_selected:"selected",class_hidden:"hidden",class_highlighted:"highlighted",class_first:"minict_first",class_last:"minict_last",beforeinit:function(){},afterinit:function(){},onchange:function(){},onopen:function(){},onclose:function(){},onfilter:function(){}};l.prototype={init:function(){this.options.beforeinit();var s=this;this.wrapper=i('<div class="'+this.options.class_container+'"></div>'),this.element.hide().after(this.wrapper),this.options.theme&&this.wrapper.addClass(this.options.theme),this.wrapper.append('<input type="text" value="'+(this.element.find("option[selected]").html()||"")+'" placeholder="'+(this.element.find("option[selected]").html()||this.options.placeholder)+'" />'),this.wrapper.append("<ul>"+s.parseSelect(s.element,s.options)+'<li class="'+s.options.class_empty+'">'+s.options.empty+"</li></ul>"),this.element.find("option[selected]").length>0&&this.wrapper.find('li[data-value="'+this.element.find("option[selected]").val()+'"]').addClass(s.options.class_selected),s.element.on("change",function(){var i=s.wrapper.find("li."+s.options.class_selected),e=s.parseSelect(s.element,s.options);s.element.val()!=i.attr("data-value")&&s.hideChoices(s.wrapper,s.options,function(){""===s.element.val()?s.wrapper.children("input").val("").attr("placeholder",s.options.placeholder):(s.wrapper.children("ul").html(e+'<li class="'+s.options.class_empty+'">'+s.options.empty+"</li>"),s.selectChoice(s.wrapper.find('li[data-value="'+s.element.val()+'"]'),s.wrapper,s.element,s.options))})}),i(e).on("click",function(){s.hideChoices(s.wrapper,s.options)}),this.wrapper.on("click",function(i){i.stopPropagation(),s.toggleChoices(s.wrapper,s.options)}),this.wrapper.on("click","li:not(."+s.options.class_group+", ."+s.options.class_empty+")",function(){s.selectChoice(i(this),s.wrapper,s.element,s.options)}),this.wrapper.on("click","li."+s.options.class_group+", li."+s.options.class_empty,function(i){i.stopPropagation(),s.wrapper.children("input").focus()}),this.wrapper.find("input").on("focus click",function(i){i.stopPropagation(),s.showChoices(s.wrapper,s.options)}).on("keyup",function(i){switch(i.keyCode){case 38:return s.navigateChoices("up",s.wrapper,s.options),!1;case 40:return s.navigateChoices("down",s.wrapper,s.options),!1;case 13:return 0!=s.wrapper.find("li."+s.options.class_highlighted).length?s.selectChoice(s.wrapper.find("li."+s.options.class_highlighted),s.wrapper,s.element,s.options):s.selectChoice(s.wrapper.find("li:not(."+s.options.class_group+", ."+s.options.class_empty+")").first(),s.wrapper,s.element,s.options),s.hideChoices(s.wrapper,s.options),!1}s.filterChoices(s.wrapper,s.options)}),this.options.afterinit()},navigateChoices:function(i,s,e){if(ignored="."+e.class_hidden+", ."+e.class_empty+", ."+e.class_group,0==s.find("li."+e.class_highlighted).length)return"up"==i?s.find("li:not("+ignored+")").last().addClass(e.class_highlighted):"down"==i&&s.find("li:not("+ignored+")").first().addClass(e.class_highlighted),!1;if(cur=s.find("li."+e.class_highlighted),cur.removeClass(e.class_highlighted),"up"==i)if(s.find("li:not("+ignored+")").first()[0]!=cur[0]){cur.prevAll("li").not(ignored).first().addClass(e.class_highlighted);var t=s.children("ul"),l=s.find("li."+e.class_highlighted).offset().top-t.offset().top+t.scrollTop();t.scrollTop()>l&&t.scrollTop(l)}else s.find("li:not("+ignored+")").last().addClass(e.class_highlighted),s.children("ul").scrollTop(s.children("ul").height());else if("down"==i)if(s.find("li:not("+ignored+")").last()[0]!=cur[0]){cur.nextAll("li").not(ignored).first().addClass(e.class_highlighted);var t=s.children("ul"),n=t.height(),a=s.find("li."+e.class_highlighted).offset().top-t.offset().top+s.find("li."+e.class_highlighted).outerHeight();a>n&&t.scrollTop(t.scrollTop()+a-n)}else s.find("li:not("+ignored+")").first().addClass(e.class_highlighted),s.children("ul").scrollTop(0)},parseSelect:function(s,e){var t="",l=this;return 0==s.find("optgroup").length?t=this.parseElements(s.html()):s.find("optgroup").each(function(){t+='<li class="'+e.class_group+'">'+i(this).attr("label")+"</li>",t+=l.parseElements(i(this).html())}),t},parseElements:function(s){var e="";return i(i.trim(s)).filter("option").each(function(){var s=i(this);""!==s.attr("value")&&(e+='<li data-value="'+s.val()+'" class="'+(s.attr("class")||"")+'">'+s.text()+"</li>")}),e},toggleChoices:function(i,s){i.hasClass(s.class_active)?this.hideChoices(i,s):this.showChoices(i,s)},showChoices:function(s,e,t){if(s.hasClass(e.class_active))"function"==typeof t&&t.call();else{this.updateFirstLast(!1,s,e);var l=this;switch(i("."+e.class_container).each(function(){i(this)[0]!=s[0]&&l.hideChoices(i(this),e)}),"function"==typeof t&&t.call(),s.addClass(e.class_active),e.transition){case"fade":s.children("ul").fadeIn(150);break;default:s.children("ul").show()}s.children("input").val("").focus(),this.options.onopen()}},resetDropdown:function(i,s,e){i.find("li").removeClass(s.class_hidden),i.find("."+s.class_empty).hide(),i.find("li."+s.class_highlighted).removeClass(s.class_highlighted),"function"==typeof e&&e.call()},hideChoices:function(i,s,e){if(i.hasClass(s.class_active)){switch(i.removeClass(s.class_active),s.transition){case"fade":i.children("ul").fadeOut(100);break;default:i.children("ul").hide()}this.resetDropdown(i,s,e),i.children("input").blur(),i.children("input").attr("placeholder")!=s.placeholder?i.children("input").val(i.children("input").attr("placeholder")):0==i.find("li."+s.class_selected).length&&i.children("input").val(""),this.options.onclose()}else"function"==typeof e&&e.call()},filterChoices:function(s,e){var t=s.children("input").val();s.find("li."+e.class_highlighted).removeClass(e.class_highlighted),s.find("li:not("+e.class_group+")").each(function(){i(this).text().search(new RegExp(t,"i"))<0?i(this).addClass(e.class_hidden):i(this).removeClass(e.class_hidden)}),s.find("li."+e.class_group).removeClass(e.class_hidden).each(function(){nextlis=i(this).nextAll("li").not("."+e.class_hidden+", ."+e.class_empty),(nextlis.first().hasClass(e.class_group)||0==nextlis.length)&&i(this).addClass(e.class_hidden)}),s.find("."+e.class_empty).hide(),0==s.find("li").not("."+e.class_hidden+", ."+e.class_empty).length?(s.find("."+e.class_empty).show(),this.options.onfilter(!1)):this.options.onfilter(!0),this.updateFirstLast(!0,s,e)},selectChoice:function(i,s,e,t){s.find("li").removeClass(t.class_selected),i.addClass(t.class_selected),s.children("input").val(i.text()).attr("placeholder",i.text()),e.find("option:selected").prop("selected",!1),e.find('option[value="'+i.attr("data-value")+'"]').prop("selected",!0),this.options.onchange(i.attr("data-value"),i.text())},updateFirstLast:function(i,s,e){s.find("."+e.class_first+", ."+e.class_last).removeClass(e.class_first+" "+e.class_last),i?(s.find("li:visible").first().addClass(e.class_first),s.find("li:visible").last().addClass(e.class_last)):(s.find("li").first().addClass(e.class_first),s.find("li").not("."+e.class_empty).last().addClass(e.class_last))}},i.fn[n]=function(s){return this.each(function(){i.data(this,"plugin_"+n)||i.data(this,"plugin_"+n,new l(this,s))})}}(jQuery,window,document);